version: "3.2"
services:
  php:
    image: dok1.jvsonline.fr/u20-php
    networks:
      - frontend
      - backend
    ports:
      - "8108:8080"
    volumes:
      - ./:/var/www/html/
      - ~/.ssh/:/user.ssh
      - ../freefw/:/var/www/freefw/
      - ../freepm/:/var/www/freepm/
      - ../freesso/:/var/www/freesso/
      - ../freeoffice/:/var/www/freeoffice/
      - ../freews/:/var/www/freews/
  apache:
    image: dok1.jvsonline.fr/u20-apache
    depends_on:
      - php
      - mysql
      - rabbit
    networks:
      - frontend
      - backend
    environment:
      - DOCUMENTROOT=www
      - SERVERNAME=omegaweb.jvsonline.fr
    ports:
      - "8180:80"
    volumes:
      - ./:/var/www/html/
      - ./docker-logs:/var/log/apache2
  mailhog:
    image: dok1.jvsonline.fr/u20-mailhog
    ports:
      - "8225:8025"
    networks:
      - backend
  rabbit:
    image: dok1.jvsonline.fr/u20-rabbitmq
    ports:
      - "8172:5672"
      - "8173:15672"
    networks:
      - backend
  mysql:
    image: dok1.jvsonline.fr/u20-mariadb
    ports:
      - "8106:3306"
    networks:
      - backend
    environment:
      - LOCAL=true
      - MYSQL_ROOT_PASSWORD=m0n1c4po
    volumes:
      - ./docker-db:/data
      - ./docker-dumps:/data/dumps
networks:
  frontend:
  backend: